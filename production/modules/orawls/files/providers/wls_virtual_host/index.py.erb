
m = ls('/VirtualHosts',returnMap='true')

f = open_file("name;channelname;target;targettype;domain;virtualhostnames", tmp_script)
for token in m:
        print '___'+token+'___'
        cd('/VirtualHosts/'+token)
        channelname = get_attribute_value('NetworkAccessPoint')

        hosts = get_attribute_value('VirtualHostNames')

        target, targetType = retrieve_target_list('/VirtualHosts/'+token)

        add_index_entry(f, [domain+'/'+token, channelname ,','.join(target),','.join(targetType),domain,','.join(hosts)])

f.close()
report_back_success()

